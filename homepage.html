<!DOCTYPE html>
<html lang="en" style="font-size: 50px; --vc-root-font-size: 4vw;">

<head>
    <title>SCF Loan Home Page</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover, user-scalable=no">
    
    <!-- 先引入creditLanguage.js，避免变量冲突 -->
    <script src="creditLanguage.js"></script>
    
    <script>
        // 读取并使用localStorage中的语言设置，但避免重复声明变量
        const selectedLang = localStorage.getItem('selectedLanguage');
        console.log("Initial language from localStorage:", selectedLang);
        if (selectedLang && (selectedLang === 'en' || selectedLang === 'th')) {
            document.documentElement.lang = selectedLang;
            console.log("Setting HTML lang attribute to:", selectedLang);
        } else {
            // 如果没有保存的语言，默认设置为英语
            localStorage.setItem('selectedLanguage', 'en');
            document.documentElement.lang = 'en';
            console.log("No language found in localStorage, setting default to: en");
        }

        // 确保全局currentLanguage变量正确初始化，与creditLanguage.js保持一致
        if (typeof window.currentLanguage === 'undefined') {
            window.currentLanguage = selectedLang || 'en';
            console.log("Initialized window.currentLanguage to:", window.currentLanguage);
        }
    </script>
    
    <link rel="stylesheet" href="css/4fa41296f441b9ff.css" data-precedence="next">
    <link rel="stylesheet" href="css/57009e3cabd11cec.css" data-precedence="next">
    <link rel="stylesheet" href="css/515e7d1e6af67b7d.css" data-precedence="next">
    <link href="css/25ac677f9c398dbc.css" rel="stylesheet" data-precedence="next">
    <link href="css/d995d26fbbce5344.css" rel="stylesheet" data-precedence="next">
    <link rel="stylesheet" href="css/5bedc7f7816ee268.css" data-precedence="next">
    <link rel="stylesheet" href="css/e90826e2f4f45792.css" data-precedence="next">
    <link rel="stylesheet" href="css/d03a5407f04b9e1e.css" data-precedence="next">
    <link rel="preload" href="css/5bedc7f7816ee268.css" as="style">
    <link rel="preload" href="css/d03a5407f04b9e1e.css" as="style">
    <link rel="preload" href="css/e90826e2f4f45792.css" as="style">
    <link rel="preload" href="images/card_mask_seller.3e06a5dd.svg" as="image" fetchpriority="high">
    
    <style type="text/css" id="react-draggable-style-el">
        .react-draggable-transparent-selection *::-moz-selection {
            all: inherit;
        }

        .react-draggable-transparent-selection *::selection {
            all: inherit;
        }
    </style>
    <!-- Added status bar styles -->
    <style>
        /* 状态栏样式 */
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #ee4d2d;
            color: #e0e0e0;
            padding: 0.1rem 0.3rem;
            font-size: 0.28rem;
            position: relative;
        }
        
        .status-left, .status-right {
            display: flex;
            align-items: center;
            z-index: 1;
            width: 33.33%;
        }
        
        .status-right {
            justify-content: flex-end;
        }
        
        .status-time {
            position: absolute;
            left: 0;
            right: 0;
            text-align: center;
            z-index: 0;
        }
        
        .wifi-icon, .battery-icon {
            width: 0.36rem;
            height: 0.36rem;
            filter: brightness(0.8);
        }
        
        .battery-level {
            margin-left: 0.1rem;
        }
        
        /* 导航栏样式 */
        .nav-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.3rem 0.5rem;
            background-color: #ee4d2d;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-left {
            display: flex;
            align-items: center;
        }
        
        .back-button {
            font-size: 0.4rem;
            margin-right: 0.4rem;
            cursor: pointer;
            border: none;
            background: none;
            color: white;
        }
        
        .page-title {
            font-size: 0.32rem;
            color: white;
        }
        
        .nav-right {
            display: flex;
            align-items: center;
        }
        
        .icon {
            width: 0.44rem;
            height: 0.44rem;
            margin-left: 0.5rem;
            cursor: pointer;
            filter: invert(1);
        }

        /* Combined container for status bar and nav bar */
        .header-container {
            background-color: #ee4d2d;
            position: sticky;
            top: 0;
            z-index: 100;
        }
    </style>
    
    <script>
        // 更新时间显示 - 放在头部预定义函数
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: false 
            });
            const timeElement = document.querySelector('.status-time');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }
        
        // 手动翻译页面内容的函数
        function translatePage() {
            try {
                const lang = localStorage.getItem('selectedLanguage') || 'en';
                console.log("Manually translating page to:", lang);
                
                // 确保window.currentLanguage与localStorage同步
                window.currentLanguage = lang;
                
                // 获取所有需要翻译的元素
                const elements = document.querySelectorAll('[data-credit-lang]');
                console.log(`Found ${elements.length} elements to translate`);
                
                // 如果creditLanguage.js正确加载，使用它的函数
                if (typeof getCreditTranslation === 'function') {
                    elements.forEach(element => {
                        const key = element.getAttribute('data-credit-lang');
                        if (key) {
                            const translation = getCreditTranslation(key);
                            element.textContent = translation;
                            console.log(`Translated "${key}" to "${translation}"`);
                        }
                    });
                    console.log("Translation completed using getCreditTranslation");
                } else {
                    console.error("getCreditTranslation function not available");
                }
                
                // 更新HTML的lang属性
                document.documentElement.lang = lang;
                
                // 如果creditLanguage.js中的updatePageLanguage可用，再次调用它
                if (typeof updatePageLanguage === 'function') {
                    updatePageLanguage();
                    console.log("Also called updatePageLanguage function");
                }
            } catch (error) {
                console.error("Error during manual translation:", error);
            }
        }
        
        // DOM加载完成后执行的函数
        document.addEventListener('DOMContentLoaded', function() {
            // 检查 creditLanguage.js 是否正确加载
            if (typeof getCreditTranslation !== 'function') {
                console.error("getCreditTranslation function not found. creditLanguage.js may not be loaded correctly.");
            }
            
            // 更新时间
            updateTime();
            // 每分钟更新一次时间
            setInterval(updateTime, 60000);
            
            // 检查通知设置并控制通知栏的显示
            const notificationBar = document.getElementById('notificationBar');
            if (notificationBar) {
                const notificationEnabled = localStorage.getItem('id_scl_v1_notificationEnabled');
                
                // 如果设置为不显示通知，则隐藏通知栏
                if (notificationEnabled === 'false') {
                    notificationBar.style.display = 'none';
                }
            }

            // 确保翻译正确应用 - 使用多种机制确保翻译被应用
            // 1. 立即尝试翻译
            translatePage();
            
            // 2. 短暂延迟后再次尝试翻译，确保DOM和脚本都已加载
            setTimeout(translatePage, 100);
            
            // 3. 如果原有的updatePageLanguage函数存在，也调用它
            setTimeout(function() {
                if (typeof updatePageLanguage === 'function') {
                    updatePageLanguage();
                    console.log("Applied translations with updatePageLanguage()");
                }
            }, 200);

            // Add back button handler
            const backButton = document.querySelector('.back-button');
            if (backButton) {
                backButton.addEventListener('click', function() {
                    window.history.back();
                });
            }
            
            // 加载余额和贷款信息
            initializePage();
        });
        
        // 初始化页面数据的函数
        function initializePage() {
            // Get URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            
            // Set default values
            const defaultDate = new Date();
            const defaultTime = document.querySelector('.status-time')?.textContent || '14:25';
            const defaultFormattedDate = defaultDate.toLocaleDateString('en-GB', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            }).replace(/\//g, '-');
            const defaultAppliedTime = `${defaultFormattedDate}, ${defaultTime}`;
            
            // Calculate default due date (1 month from now)
            const defaultDueDate = (() => {
                const date = new Date(defaultDate);
                date.setMonth(date.getMonth() + 1);
                return date.toLocaleDateString('en-GB', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                }).replace(/\//g, '-');
            })();
            
            // Format number with thousand separators and 2 decimal places
            const formatCurrency = (number) => {
                return number.toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
            };
            
            // Constants
            const TOTAL_CREDIT_LIMIT = 5000.00;
            const DEFAULT_LOAN_AMOUNT = 300.00;
            const INSTALMENT_FEE = 45.00;
            
            // Use URL parameters or default values
            const totalPayment = parseFloat(urlParams.get('totalPayment')) || DEFAULT_LOAN_AMOUNT;
            const dueDate = urlParams.get('dueDate') || defaultDueDate;
            const appliedTime = urlParams.get('appliedTime') || defaultAppliedTime;
            const repayAmount = parseFloat(urlParams.get('repayAmount')) || (totalPayment + INSTALMENT_FEE);
            
            try {
                // Update loan amount and due date in the current loans section
                const loanAmountTitle = document.querySelector('.adm-list-item-title');
                if (loanAmountTitle) {
                    if (typeof getCreditTranslation === 'function') {
                        const loanAmountText = getCreditTranslation('loan_amount');
                        loanAmountTitle.innerHTML = `<span data-credit-lang="loan_amount">${loanAmountText}</span> ฿ ${formatCurrency(totalPayment)}`;
                    }
                }
                
                const loanDueDate = document.querySelector('.adm-list-item-description');
                if (loanDueDate) {
                    if (typeof getCreditTranslation === 'function') {
                        const dueOnText = getCreditTranslation('due_on');
                        loanDueDate.innerHTML = `฿ ${formatCurrency(repayAmount)} <span data-credit-lang="due_on">${dueOnText}</span> ${dueDate}`;
                    }
                }

                // Add click handler for loan item
                const loanItem = document.querySelector('.adm-list-item.adm-plain-anchor');
                if (loanItem) {
                    loanItem.style.cursor = 'pointer';
                    loanItem.addEventListener('click', function() {
                        const params = new URLSearchParams({
                            repayAmount: (totalPayment + INSTALMENT_FEE).toFixed(2),
                            dueDate: dueDate
                        });
                        window.location.href = `repayPage.html?${params.toString()}`;
                    });
                }

                // Calculate and update Available Credit Limit
                const availableCreditLimit = TOTAL_CREDIT_LIMIT - totalPayment;
                
                // Update Available Credit Limit display
                const availableAmountElement = document.querySelector('.Banner_availableAmount__X6GaB');
                if (availableAmountElement) {
                    availableAmountElement.innerHTML = `<span class="Banner_symbol__hW40M">฿</span> ${formatCurrency(availableCreditLimit)}`;
                }

                // Update Total Credit Limit display
                const totalLimitElement = document.querySelector('.Banner_left__yEoOH');
                if (totalLimitElement && typeof getCreditTranslation === 'function') {
                    const totalCreditLimitText = getCreditTranslation('total_credit_limit');
                    totalLimitElement.innerHTML = `<span data-credit-lang="total_credit_limit">${totalCreditLimitText}</span> ฿ ${formatCurrency(TOTAL_CREDIT_LIMIT)}`;
                }

                console.log("Homepage initialized successfully");
            } catch (error) {
                console.error("Error during page initialization:", error);
            }
        }
        
        // 防止顶部过度滚动
        document.addEventListener('scroll', function(e) {
            if (window.scrollY < 0) {
                window.scrollTo(0, 0);
            }
            
            // 确保header在滚动时保持在内容上方
            const header = document.querySelector('.header-container');
            if (header) {
                if (window.scrollY > 0) {
                    header.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.1)';
                } else {
                    header.style.boxShadow = 'none';
                }
            }
        }, { passive: false });
    </script>
</head>

<body>
    <!--$--><!--$--><!--/$--><!--/$-->
    <!-- Added status bar -->
    <div class="header-container">
        <!-- Status bar -->
        <div class="status-bar">
            <div class="status-left">
                <img src="images/wifi-red.svg" class="wifi-icon" alt="WiFi">
            </div>
            <div class="status-time">14:25</div>
            <div class="status-right">
                <img src="images/battery-red.svg" class="battery-icon" alt="Battery">
                <span class="battery-level">85%</span>
            </div>
        </div>

        <!-- Nav bar -->
        <div class="nav-bar">
            <div class="nav-left">
                <button class="back-button">←</button>
                <div class="page-title" data-credit-lang="easypay_for_sellers">SEasyPay for Sellers</div>
            </div>
            <div class="nav-right">
                <img src="images/clock.svg" alt="Clock" class="icon">
                <img src="images/settings.svg" alt="Settings" class="icon" onclick="window.location.href='settingsPage.html'">
            </div>
        </div>
    </div>
    
    <div class="page_wrapper__S2D2l">
        <div class="Banner_wrapper__laxoh">
            <div class="Banner_card__X6oK6"><img alt="card_mask" fetchpriority="high" width="375" height="186"
                    decoding="async" data-nimg="1" class="Banner_cardMask__4EEYJ"
                    srcset="images/card_mask_seller.3e06a5dd.svg 1x, images/card_mask_seller.3e06a5dd.svg 2x"
                    src="images/card_mask_seller.3e06a5dd.svg"
                    style="color: transparent;">
                <div class="Banner_box__H0bqq">
                    <div class="Banner_title__SaZjV" data-credit-lang="available_credit_limit">Available Credit Limit</div>
                    <section>
                        <div class="Banner_availableAmount__X6GaB"><span
                                class="Banner_symbol__hW40M">฿</span> 4,700.00</div>
                        <div class="Banner_totalLimitDesc__MCRCx"><span data-credit-lang="you_can_pay">You can pay within available credit.</span>
                        </div>
                    </section>
                    <div class="Banner_btnWrapper__Qo6zc"><a href="/loan/apply"><button type="button"
                                class="adm-button adm-button-default adm-button-fill-outline adm-button-shape-default Banner_withdrawBtn__aoTp8"><span data-credit-lang="use_now">Use Now</span></button></a></div>
                    <div class="Banner_initTempLimitEntry__gQNB6">
                        <div class="Banner_left__yEoOH"><span data-credit-lang="total_credit_limit">Total Credit Limit</span> ฿ 5,000.00</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="page_promotionBannerWrapper__ySenj credit-promotion-sdk-banner-swipe mobile-layout"
            style="display: none; visibility: visible;">
            <div class="credit-promotion-sdk-banner-swipe-wrapper" style="width: 0px;"></div>
        </div>
        <div class="adm-list adm-list-default CurrentLoans_currentLoans__eZmvY CurrentLoans_list__MhuyZ">
            <div class="adm-list-body">
                <div class="adm-list-body-inner">
                    <div class="adm-list-item">
                        <div class="adm-list-item-content">
                            <div class="adm-list-item-content-prefix"><img alt="" loading="lazy" width="20" height="20"
                                    decoding="async" data-nimg="1" class="CurrentLoans_icon__8DTb2"
                                    srcset="images/upcoming.357105d5.svg 1x, images/upcoming.357105d5.svg 2x"
                                    src="images/upcoming.357105d5.svg"
                                    style="color: transparent;"></div>
                            <div class="adm-list-item-content-main" data-credit-lang="outstanding_loans">Outstanding Loans</div>
                        </div>
                    </div><a class="adm-list-item adm-plain-anchor">
                        <div class="adm-list-item-content">
                            <div class="adm-list-item-content-main">
                                <div class="adm-list-item-title"><span data-credit-lang="loan_amount">Loan amount:</span> ฿ 300.00</div>
                                <div class="adm-list-item-description">฿ 345.00 <span data-credit-lang="due_on">due on</span> 19-04-2024</div>
                            </div>
                            <div class="adm-list-item-content-extra">
                                <div class="CurrentLoans_extraArea__Bz1ks">
                                    <div>0/1 <span data-credit-lang="paid">Paid</span></div>
                                </div>
                            </div>
                            <div class="adm-list-item-content-arrow"><svg width="1em" height="1em" viewBox="0 0 48 48"
                                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    class="antd-mobile-icon" style="vertical-align: -0.125em;">
                                    <g id="RightOutline-RightOutline" stroke="none" stroke-width="1" fill="none"
                                        fill-rule="evenodd">
                                        <g id="RightOutline-RightOutlined">
                                            <rect id="RightOutline-矩形" fill="#FFFFFF" opacity="0" x="0" y="0" width="48"
                                                height="48"></rect>
                                            <path
                                                d="M17.3947957,5.11219264 L35.5767382,22.6612572 L35.5767382,22.6612572 C36.1304785,23.2125856 36.1630514,24.0863155 35.6744571,24.6755735 L35.5767382,24.7825775 L17.3956061,42.8834676 C17.320643,42.9580998 17.2191697,43 17.1133896,43 L13.9866673,43 C13.7657534,43 13.5866673,42.8209139 13.5866673,42.6 C13.5866673,42.4936115 13.6290496,42.391606 13.7044413,42.316542 L32.3201933,23.7816937 L32.3201933,23.7816937 L13.7237117,5.6866816 C13.5653818,5.53262122 13.5619207,5.27937888 13.7159811,5.121049 C13.7912854,5.04365775 13.8946805,5 14.0026627,5 L17.1170064,5 C17.2206403,5 17.3202292,5.04022164 17.3947957,5.11219264 Z"
                                                id="RightOutline-right" fill="currentColor" fill-rule="nonzero"></path>
                                        </g>
                                    </g>
                                </svg></div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
        <div class="page_promotionBannerWrapper__ySenj credit-promotion-sdk-banner-swipe mobile-layout"
            style="display: none; visibility: visible;">
            <div class="credit-promotion-sdk-banner-swipe-wrapper" style="width: 0px;"></div>
        </div>
    </div>
    <link rel="preload" as="style"
        href="css/d995d26fbbce5344.css">
    <link rel="preload" as="image"
        imagesrcset="images/card_mask_seller.3e06a5dd.svg 1x, images/card_mask_seller.3e06a5dd.svg 2x"
        fetchpriority="high">
        
    <!-- 调试信息和日志，方便排查问题 -->
    <script>
        // 页面完全加载后的最终检查
        window.addEventListener('load', function() {
            console.log("=== LANGUAGE DEBUG INFO ===");
            console.log("HTML lang attribute:", document.documentElement.lang);
            console.log("localStorage selectedLanguage:", localStorage.getItem('selectedLanguage'));
            console.log("window.currentLanguage:", typeof window.currentLanguage !== 'undefined' ? window.currentLanguage : "undefined");
            
            // 最后一次尝试翻译，确保所有内容都已翻译
            setTimeout(function() {
                translatePage();
                console.log("Final translation attempt completed");
            }, 500);
        });
    </script>
</body>
</html>